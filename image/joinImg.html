<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>图片拼接工具-传道软件</title>
	<meta name="keywords" content="在线软件工具集合、传道软件">
	<meta name="description" content="传道软件是一款在线软件工具集合，无需登录，无需费用，用完就走的软件工具。包括生活类、开发类、编码解码、加密解密、图片类、娱乐类的软件工具结合。">
	<link rel="icon" href="../favicon.ico" type="image/x-icon"/>
	<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		.nav {
			max-width: 1200px;
			margin: 0 auto;
			display: flex;
			gap: 20px;
		}
		.nav-item {
			color: #666;
			text-decoration: none;
			font-size: 14px;
			display: flex;
			align-items: center;
			gap: 5px;
		}
		.container {
			max-width: 1200px;
			margin: 0 auto;
			background: white;
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		}
		.image-container {
			display: flex;
			gap: 20px;
			margin-bottom: 20px;
		}
		.image-box {
			flex: 1;
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 10px;
		}
		.image-preview {
			width: 100%;
			height: 300px;
			border: 2px dashed #ddd;
			border-radius: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			overflow: hidden;
			background-color: #f8f9fa;
		}
		.image-preview img {
			max-width: 100%;
			max-height: 100%;
			object-fit: contain;
		}
		.button {
			width: 100%;
			padding: 12px;
			border: none;
			border-radius: 4px;
			font-size: 16px;
			cursor: pointer;
			transition: background-color 0.3s;
		}
		.upload-btn {
			background-color: #ff6b6b;
			color: white;
		}
		.upload-btn:hover {
			background-color: #ff5252;
		}
		.download-btn {
			background-color: #f8f9fa;
			color: #333;
			border: 1px solid #ddd;
		}
		.download-btn:hover {
			background-color: #e9ecef;
		}
		.info-box {
			margin-top: 20px;
			padding: 15px;
			background: #fff5f0;
			border-radius: 4px;
		}
		.info-title {
			color: #ff6b6b;
			margin-bottom: 10px;
		}
		.info-list {
			list-style: none;
			color: #666;
			font-size: 14px;
			line-height: 1.8;
		}
		.info-list li {
			margin-bottom: 5px;
		}
	</style>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
	<script>
		tailwind.config = {
			theme: {
				extend: {
					colors: {
						primary: '#3b82f6',
						secondary: '#f97316',
						neutral: '#f3f4f6',
					},
					fontFamily: {
						inter: ['Inter', 'system-ui', 'sans-serif'],
					},
				}
			}
		}
	</script>
	<style type="text/tailwindcss">
		@layer utilities {
			.content-auto {
				content-visibility: auto;
			}
			.shadow-soft {
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
			}
			.transition-custom {
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}
		}
	</style>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: system-ui, -apple-system, sans-serif;
		}

		body {
			background-color: #f5f5f5;
		}

		/* 响应式导航栏 */
		nav {
			background: white;
			padding: 1rem 2rem;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			position: relative;
		}

		.nav-container {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.nav-categories {
			display: flex;
			gap: 2rem;
		}

		.nav-category {
			color: #666;
			cursor: pointer;
			transition: color 0.3s;
			white-space: nowrap;
			text-decoration: none;
		}

		.nav-category:hover {
			color: #007bff;
		}

		.menu-btn {
			display: none;
			background: none;
			border: none;
			font-size: 1.2rem;
			cursor: pointer;
		}

		.container {
			max-width: 1200px;
			margin: 2rem auto;
			padding: 0 1rem;
		}

		/* 工具卡片布局 */
		.tools-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
			gap: 1.5rem;
			padding: 1rem;
		}

		.tool-card {
			background: white;
			border-radius: 8px;
			padding: 1rem;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			transition: transform 0.3s;
		}

		.tool-card:hover {
			transform: translateY(-3px);
		}

		.tool-icon {
			font-size: 1.5rem;
			color: #007bff;
			margin-bottom: 1rem;
		}

		.category-title {
			color: #444;
			margin: 2rem 0 1rem;
			padding-left: 1rem;
		}

		/* 移动端样式 */
		@media (max-width: 768px) {
			.nav-categories {
				display: none;
				position: absolute;
				top: 100%;
				left: 0;
				right: 0;
				background: white;
				flex-direction: column;
				padding: 1rem;
				box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			}

			.nav-categories.active {
				display: flex;
			}

			.nav-category {
				padding: 0.5rem 0;
				text-decoration: none;
			}

			.menu-btn {
				display: block;
			}

			nav {
				padding: 1rem;
			}
		}
	</style>
	<!-- Google tag (gtag.js2) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-HWMGEQS9C0"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-HWMGEQS9C0');
	</script>

	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7274710287377352"
			crossorigin="anonymous"></script>


</head>
<body>
<nav>
	<div class="nav-container">
		<div class="logo">
			<a href="../index.html" class="nav-item">
				<img src="../static/images/logo.png" width="100px" style="margin-right: 60px"/>
			</a>
		</div>
		<button class="menu-btn" onclick="toggleMenu()">☰</button>
		<div class="nav-categories">
			<a href="../index.html" class="nav-category">🔍 推荐工具</a>
			<a href="../life.html" class="nav-category">🏠 生活工具</a>
			<a href="../encry.html" class="nav-category">🔒 加密解密</a>
			<a href="../code.html" class="nav-category">📝 编码解码</a>
			<a href="../dev.html" class="nav-category">💻 开发工具</a>
			<a href="../image.html" class="nav-category">🖼️ 图片处理</a>
			<a href="../game.html" class="nav-category">🎮 娱乐工具</a>
		</div>
	</div>
</nav>

<div class="container">

	<!-- 主要内容区 -->
	<main class="flex-grow container mx-auto px-4 py-8">
		<div class="max-w-5xl mx-auto bg-white rounded-xl shadow-soft p-6 md:p-8">
			<!-- 标题和描述 -->
			<div class="text-center mb-8">
				<h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-gray-800 mb-3">轻松拼接你的图片</h2>
				<p class="text-gray-600 max-w-2xl mx-auto">上传多张图片，选择拼接方式，生成一张无缝拼接的图片。支持横向和纵向拼接，自定义间距和背景。</p>
			</div>

			<!-- 上传区域 -->
			<div class="mb-8">
				<div id="drop-area" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-custom hover:border-primary cursor-pointer bg-neutral">
					<i class="fa fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
					<h3 class="text-lg font-medium text-gray-700 mb-2">拖放图片到这里</h3>
					<p class="text-gray-500 mb-4">或者</p>
					<label class="inline-block bg-primary hover:bg-primary/90 text-white font-medium py-2 px-6 rounded-md cursor-pointer transition-custom">
						<i class="fa fa-folder-open mr-2"></i>选择图片
						<input type="file" id="file-input" class="hidden" multiple accept="image/*">
					</label>
					<p class="mt-4 text-sm text-gray-500">支持 JPG, PNG, WebP 格式</p>
				</div>

				<!-- 已上传图片预览 -->
				<div id="preview-container" class="mt-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 hidden">
					<h4 class="col-span-full text-lg font-medium text-gray-700 mb-2">已上传图片</h4>
					<div id="image-previews" class="col-span-full grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
				</div>
			</div>

			<!-- 拼接选项 -->
			<div class="mb-8">
				<h3 class="text-lg font-medium text-gray-700 mb-4">拼接选项</h3>
				<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
					<!-- 拼接方向 -->
					<div>
						<label class="block text-sm font-medium text-gray-700 mb-2">拼接方向</label>
						<div class="flex space-x-4">
							<label class="flex items-center space-x-2 cursor-pointer">
								<input type="radio" name="direction" value="horizontal" checked class="w-4 h-4 text-primary focus:ring-primary">
								<span>横向</span>
							</label>
							<label class="flex items-center space-x-2 cursor-pointer">
								<input type="radio" name="direction" value="vertical" class="w-4 h-4 text-primary focus:ring-primary">
								<span>纵向</span>
							</label>
						</div>
					</div>

					<!-- 间距设置 -->
					<div>
						<label for="spacing" class="block text-sm font-medium text-gray-700 mb-2">图片间距 (像素)</label>
						<input type="range" id="spacing" min="0" max="50" value="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
						<div class="flex justify-between text-xs text-gray-500 mt-1">
							<span>0</span>
							<span id="spacing-value">10</span>
							<span>50</span>
						</div>
					</div>

					<!-- 背景颜色 -->
					<div>
						<label for="background" class="block text-sm font-medium text-gray-700 mb-2">背景颜色</label>
						<div class="flex items-center space-x-4">
							<input type="color" id="background" value="#ffffff" class="w-10 h-10 rounded-full border-0 cursor-pointer">
							<input type="text" id="background-text" value="#ffffff" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary">
						</div>
					</div>

					<!-- 图片质量 -->
					<div>
						<label for="quality" class="block text-sm font-medium text-gray-700 mb-2">输出质量 (JPG)</label>
						<input type="range" id="quality" min="0.1" max="1" step="0.1" value="0.9" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
						<div class="flex justify-between text-xs text-gray-500 mt-1">
							<span>低</span>
							<span id="quality-value">0.9</span>
							<span>高</span>
						</div>
					</div>
				</div>
			</div>

			<!-- 操作按钮 -->
			<div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-8">
				<button id="clear-btn" class="w-full sm:w-auto px-6 py-2 border border-gray-300 rounded-md text-gray-700 font-medium hover:bg-gray-50 transition-custom flex items-center justify-center">
					<i class="fa fa-trash mr-2"></i>清除图片
				</button>
				<button id="stitch-btn" class="w-full sm:w-auto px-6 py-2 bg-secondary hover:bg-secondary/90 text-white font-medium rounded-md transition-custom flex items-center justify-center">
					<i class="fa fa-magic mr-2"></i>开始拼接
				</button>
			</div>

			<!-- 拼接结果 -->
			<div id="result-container" class="hidden">
				<h3 class="text-lg font-medium text-gray-700 mb-4">拼接结果</h3>
				<div class="bg-neutral rounded-lg p-4 flex flex-col items-center">
					<div id="loading-indicator" class="hidden mb-4">
						<div class="w-10 h-10 border-4 border-gray-200 border-t-primary rounded-full animate-spin mx-auto"></div>
						<p class="text-gray-600 mt-2">正在处理图片...</p>
					</div>
					<div id="result-image-container" class="relative max-w-full overflow-auto">
						<img id="result-image" src="" alt="拼接结果" class="max-w-full rounded shadow-md">
						<div class="top-2 right-2 hover:opacity-100 transition-opacity">
							<button id="download-btn" class="bg-gray-800/80 hover:bg-gray-800 text-white p-2 rounded-full">
								<i class="fa fa-download"></i>
							</button>
						</div>
					</div>
				</div>
			</div>

		</div>
	</main>
</div>

<script>
	// 存储上传的图片
	let uploadedImages = [];

	// DOM 元素
	const dropArea = document.getElementById('drop-area');
	const fileInput = document.getElementById('file-input');
	const previewContainer = document.getElementById('preview-container');
	const imagePreviews = document.getElementById('image-previews');
	const stitchBtn = document.getElementById('stitch-btn');
	const clearBtn = document.getElementById('clear-btn');
	const resultContainer = document.getElementById('result-container');
	const resultImage = document.getElementById('result-image');
	const downloadBtn = document.getElementById('download-btn');
	const loadingIndicator = document.getElementById('loading-indicator');
	const spacingInput = document.getElementById('spacing');
	const spacingValue = document.getElementById('spacing-value');
	const qualityInput = document.getElementById('quality');
	const qualityValue = document.getElementById('quality-value');
	const backgroundInput = document.getElementById('background');
	const backgroundText = document.getElementById('background-text');

	// 更新间距显示
	spacingInput.addEventListener('input', () => {
		spacingValue.textContent = spacingInput.value;
	});

	// 更新质量显示
	qualityInput.addEventListener('input', () => {
		qualityValue.textContent = qualityInput.value;
	});

	// 同步背景颜色输入
	backgroundInput.addEventListener('input', () => {
		backgroundText.value = backgroundInput.value;
	});

	backgroundText.addEventListener('input', () => {
		// 验证颜色格式
		if (/^#([0-9A-F]{3}){1,2}$/i.test(backgroundText.value)) {
			backgroundInput.value = backgroundText.value;
		}
	});

	// 拖放事件处理
	['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
		dropArea.addEventListener(eventName, preventDefaults, false);
	});

	function preventDefaults(e) {
		e.preventDefault();
		e.stopPropagation();
	}

	['dragenter', 'dragover'].forEach(eventName => {
		dropArea.addEventListener(eventName, highlight, false);
	});

	['dragleave', 'drop'].forEach(eventName => {
		dropArea.addEventListener(eventName, unhighlight, false);
	});

	function highlight() {
		dropArea.classList.add('border-primary', 'bg-primary/5');
	}

	function unhighlight() {
		dropArea.classList.remove('border-primary', 'bg-primary/5');
	}

	dropArea.addEventListener('drop', handleDrop, false);

	function handleDrop(e) {
		const dt = e.dataTransfer;
		const files = dt.files;
		handleFiles(files);
	}

	// 文件选择
	fileInput.addEventListener('change', () => {
		handleFiles(fileInput.files);
	});

	// 点击上传区域也触发文件选择
	dropArea.addEventListener('click', () => {
		if (!previewContainer.classList.contains('hidden')) {
			fileInput.click();
		}
	});

	// 处理文件
	function handleFiles(files) {
		for (let i = 0; i < files.length; i++) {
			const file = files[i];
			if (!file.type.match('image.*')) continue;

			const reader = new FileReader();

			reader.onload = function(e) {
				const img = new Image();
				img.onload = function() {
					// 存储图片信息
					uploadedImages.push({
						src: e.target.result,
						width: img.width,
						height: img.height
					});

					// 创建预览
					createImagePreview(e.target.result);

					// 显示预览容器
					previewContainer.classList.remove('hidden');
				};
				img.src = e.target.result;
			};

			reader.readAsDataURL(file);
		}
	}

	// 创建图片预览
	function createImagePreview(src) {
		const preview = document.createElement('div');
		preview.className = 'relative group';
		preview.innerHTML = `
                <img src="${src}" alt="预览图" class="w-full h-32 object-cover rounded-lg shadow-sm">
                <button class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity bg-red-500 hover:bg-red-600 text-white p-1 rounded-full">
                    <i class="fa fa-times"></i>
                </button>
            `;

		// 删除按钮事件
		const deleteBtn = preview.querySelector('button');
		deleteBtn.addEventListener('click', () => {
			// 从数组中删除图片
			const imgSrc = preview.querySelector('img').src;
			uploadedImages = uploadedImages.filter(img => img.src !== imgSrc);

			// 移除预览
			preview.remove();

			// 如果没有图片了，隐藏预览容器
			if (uploadedImages.length === 0) {
				previewContainer.classList.add('hidden');
			}
		});

		imagePreviews.appendChild(preview);
	}

	// 清除所有图片
	clearBtn.addEventListener('click', () => {
		uploadedImages = [];
		imagePreviews.innerHTML = '';
		previewContainer.classList.add('hidden');
		resultContainer.classList.add('hidden');
	});

	// 拼接图片
	stitchBtn.addEventListener('click', stitchImages);

	// 下载图片
	downloadBtn.addEventListener('click', () => {
		const link = document.createElement('a');
		link.download = 'stitched-image.jpg';
		link.href = resultImage.src;
		link.click();
	});

	// 图片拼接功能
	function stitchImages() {
		if (uploadedImages.length < 2) {
			alert('请上传至少两张图片进行拼接');
			return;
		}

		// 显示加载指示器
		resultContainer.classList.remove('hidden');
		loadingIndicator.classList.remove('hidden');
		resultImage.style.display = 'none';

		// 异步处理图片，避免阻塞UI
		setTimeout(() => {
			try {
				// 获取选项
				const direction = document.querySelector('input[name="direction"]:checked').value;
				const spacing = parseInt(spacingInput.value);
				const quality = parseFloat(qualityInput.value);
				const background = backgroundInput.value;

				// 创建画布
				const canvas = document.createElement('canvas');
				const ctx = canvas.getContext('2d');

				// 计算画布尺寸
				let totalWidth = 0;
				let totalHeight = 0;
				let maxWidth = 0;
				let maxHeight = 0;

				uploadedImages.forEach(img => {
					maxWidth = Math.max(maxWidth, img.width);
					maxHeight = Math.max(maxHeight, img.height);
				});

				if (direction === 'horizontal') {
					// 横向拼接
					totalWidth = uploadedImages.reduce((sum, img) => sum + img.width, 0) + (uploadedImages.length - 1) * spacing;
					totalHeight = maxHeight;
				} else {
					// 纵向拼接
					totalWidth = maxWidth;
					totalHeight = uploadedImages.reduce((sum, img) => sum + img.height, 0) + (uploadedImages.length - 1) * spacing;
				}

				// 设置画布尺寸
				canvas.width = totalWidth;
				canvas.height = totalHeight;

				// 设置背景
				ctx.fillStyle = background;
				ctx.fillRect(0, 0, canvas.width, canvas.height);

				// 绘制图片
				let currentX = 0;
				let currentY = 0;

				uploadedImages.forEach(img => {
					const imageObj = new Image();
					imageObj.src = img.src;

					if (direction === 'horizontal') {
						ctx.drawImage(imageObj, currentX, 0, img.width, img.height);
						currentX += img.width + spacing;
					} else {
						ctx.drawImage(imageObj, 0, currentY, img.width, img.height);
						currentY += img.height + spacing;
					}
				});

				// 生成结果图片
				const result = canvas.toDataURL('image/jpeg', quality);

				// 更新UI
				resultImage.src = result;
				loadingIndicator.classList.add('hidden');
				resultImage.style.display = 'block';

				// 平滑滚动到结果区域
				resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });

			} catch (error) {
				console.error('拼接图片时出错:', error);
				alert('拼接图片时出错，请重试');
				loadingIndicator.classList.add('hidden');
			}
		}, 100);
	}

</script>
</body>

<script>
	function toggleMenu() {
		const nav = document.querySelector('.nav-categories');
		nav.classList.toggle('active');

		// 点击菜单项后自动关闭
		document.querySelectorAll('.nav-category').forEach(item => {
			item.addEventListener('click', () => {
				if (window.innerWidth <= 768) {
					nav.classList.remove('active');
				}
			});
		});
	}
</script>



</html>
