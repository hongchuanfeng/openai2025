<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>å›¾ç‰‡åŠ æ–‡å­—-ä¼ é“è½¯ä»¶</title>
	<meta name="keywords" content="åœ¨çº¿è½¯ä»¶å·¥å…·é›†åˆã€ä¼ é“è½¯ä»¶">
	<meta name="description" content="ä¼ é“è½¯ä»¶æ˜¯ä¸€æ¬¾åœ¨çº¿è½¯ä»¶å·¥å…·é›†åˆï¼Œæ— éœ€ç™»å½•ï¼Œæ— éœ€è´¹ç”¨ï¼Œç”¨å®Œå°±èµ°çš„è½¯ä»¶å·¥å…·ã€‚åŒ…æ‹¬ç”Ÿæ´»ç±»ã€å¼€å‘ç±»ã€ç¼–ç è§£ç ã€åŠ å¯†è§£å¯†ã€å›¾ç‰‡ç±»ã€å¨±ä¹ç±»çš„è½¯ä»¶å·¥å…·ç»“åˆã€‚">
	<link rel="canonical" href="https://chdaoai.com/">
	<link rel="icon" href="../favicon.ico" type="image/x-icon"/>
	<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		.nav {
			max-width: 1200px;
			margin: 0 auto;
			display: flex;
			gap: 20px;
		}
		.nav-item {
			color: #666;
			text-decoration: none;
			font-size: 14px;
			display: flex;
			align-items: center;
			gap: 5px;
		}
		.container {
			max-width: 1200px;
			margin: 0 auto;
			background: white;
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		}
		.image-container {
			display: flex;
			gap: 20px;
			margin-bottom: 20px;
		}
		.image-box {
			flex: 1;
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 10px;
		}
		.image-preview {
			width: 100%;
			height: 300px;
			border: 2px dashed #ddd;
			border-radius: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			overflow: hidden;
			background-color: #f8f9fa;
		}
		.image-preview img {
			max-width: 100%;
			max-height: 100%;
			object-fit: contain;
		}
		.button {
			width: 100%;
			padding: 12px;
			border: none;
			border-radius: 4px;
			font-size: 16px;
			cursor: pointer;
			transition: background-color 0.3s;
		}
		.upload-btn {
			background-color: #ff6b6b;
			color: white;
		}
		.upload-btn:hover {
			background-color: #ff5252;
		}
		.download-btn {
			background-color: #f8f9fa;
			color: #333;
			border: 1px solid #ddd;
		}
		.download-btn:hover {
			background-color: #e9ecef;
		}
		.info-box {
			margin-top: 20px;
			padding: 15px;
			background: #fff5f0;
			border-radius: 4px;
		}
		.info-title {
			color: #ff6b6b;
			margin-bottom: 10px;
		}
		.info-list {
			list-style: none;
			color: #666;
			font-size: 14px;
			line-height: 1.8;
		}
		.info-list li {
			margin-bottom: 5px;
		}
	</style>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
	<script>
		tailwind.config = {
			theme: {
				extend: {
					colors: {
						primary: '#165DFF',
						secondary: '#FF7D00',
						neutral: '#F5F7FA',
					},
					fontFamily: {
						inter: ['Inter', 'system-ui', 'sans-serif'],
					},
				}
			}
		}
	</script>
	<style type="text/tailwindcss">
		@layer utilities {
			.content-auto {
				content-visibility: auto;
			}
			.shadow-soft {
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
			}
			.transition-custom {
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}
			.text-shadow {
				text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}
		}
	</style>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: system-ui, -apple-system, sans-serif;
		}

		body {
			background-color: #f5f5f5;
		}

		/* å“åº”å¼å¯¼èˆªæ  */
		nav {
			background: white;
			padding: 1rem 2rem;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			position: relative;
		}

		.nav-container {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.nav-categories {
			display: flex;
			gap: 2rem;
			z-index: 999;
		}

		.nav-category {
			color: #666;
			cursor: pointer;
			transition: color 0.3s;
			white-space: nowrap;
			text-decoration: none;
		}

		.nav-category:hover {
			color: #007bff;
		}

		.menu-btn {
			display: none;
			background: none;
			border: none;
			font-size: 1.2rem;
			cursor: pointer;
		}

		.container {
			max-width: 1200px;
			margin: 2rem auto;
			padding: 0 1rem;
		}

		/* å·¥å…·å¡ç‰‡å¸ƒå±€ */
		.tools-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
			gap: 1.5rem;
			padding: 1rem;
		}

		.tool-card {
			background: white;
			border-radius: 8px;
			padding: 1rem;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			transition: transform 0.3s;
		}

		.tool-card:hover {
			transform: translateY(-3px);
		}

		.tool-icon {
			font-size: 1.5rem;
			color: #007bff;
			margin-bottom: 1rem;
		}

		.category-title {
			color: #444;
			margin: 2rem 0 1rem;
			padding-left: 1rem;
		}

		/* ç§»åŠ¨ç«¯æ ·å¼ */
		@media (max-width: 768px) {
			.nav-categories {
				display: none;
				position: absolute;
				top: 100%;
				left: 0;
				right: 0;
				background: white;
				flex-direction: column;
				padding: 1rem;
				box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			}

			.nav-categories.active {
				display: flex;
			}

			.nav-category {
				padding: 0.5rem 0;
				text-decoration: none;
			}

			.menu-btn {
				display: block;
			}

			nav {
				padding: 1rem;
			}
		}
	</style>
	<!-- Google tag (gtag.js2) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-8NMLH22Y6G"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-8NMLH22Y6G');
	</script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7274710287377352"
			crossorigin="anonymous"></script>


</head>
<body>
<nav>
	<div class="nav-container">
		<div class="logo">
			<a href="../index.html" class="nav-item">
				<img src="../static/images/logo.png" width="100px" style="margin-right: 60px"/>
			</a>
		</div>
		<button class="menu-btn" onclick="toggleMenu()">â˜°</button>
		<div class="nav-categories">
			<a href="../index.html" class="nav-category">ğŸ” æ¨èå·¥å…·</a>
			<a href="../life.html" class="nav-category">ğŸ  ç”Ÿæ´»å·¥å…·</a>
			<a href="../encry.html" class="nav-category">ğŸ”’ åŠ å¯†è§£å¯†</a>
			<a href="../code.html" class="nav-category">ğŸ“ ç¼–ç è§£ç </a>
			<a href="../dev.html" class="nav-category">ğŸ’» å¼€å‘å·¥å…·</a>
			<a href="../image.html" class="nav-category">ğŸ–¼ï¸ å›¾ç‰‡å¤„ç†</a>
			<a href="../game.html" class="nav-category">ğŸ® å¨±ä¹å·¥å…·</a>
		</div>
	</div>
</nav>

<div class="container">

	<!-- ä¸»è¦å†…å®¹åŒº -->
	<main class="flex-grow container mx-auto px-4 py-8">
		<div class="max-w-6xl mx-auto">
			<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
				<!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
				<div class="lg:col-span-1">
					<div class="bg-white rounded-xl shadow-soft p-6 sticky top-24">
						<h2 class="text-xl font-bold text-gray-800 mb-6">ç¼–è¾‘é€‰é¡¹</h2>

						<!-- ä¸Šä¼ å›¾ç‰‡ -->
						<div class="mb-6">
							<label class="block text-sm font-medium text-gray-700 mb-2">é€‰æ‹©å›¾ç‰‡</label>
							<div id="drop-area" class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center transition-custom hover:border-primary cursor-pointer bg-neutral">
								<i class="fa fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
								<p class="text-sm text-gray-500">æ‹–æ”¾å›¾ç‰‡åˆ°è¿™é‡Œæˆ–</p>
								<label class="inline-block mt-2 bg-primary hover:bg-primary/90 text-white text-sm font-medium py-1.5 px-4 rounded-md cursor-pointer transition-custom">
									<i class="fa fa-folder-open mr-1"></i>é€‰æ‹©å›¾ç‰‡
									<input type="file" id="file-input" class="hidden" accept="image/*">
								</label>
							</div>
							<div id="image-preview" class="mt-4 hidden">
								<img id="preview-img" src="" alt="é¢„è§ˆå›¾" class="w-full h-auto rounded-lg shadow-sm">
								<button id="remove-img" class="mt-2 text-sm text-red-500 hover:text-red-600 transition-custom">
									<i class="fa fa-trash mr-1"></i>ç§»é™¤å›¾ç‰‡
								</button>
							</div>
						</div>

						<!-- æ·»åŠ æ–‡å­— -->
						<div class="mb-6">
							<label class="block text-sm font-medium text-gray-700 mb-2">æ·»åŠ æ–‡å­—</label>
							<textarea id="text-input" rows="2" placeholder="è¾“å…¥è¦æ·»åŠ çš„æ–‡å­—..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"></textarea>
							<button id="add-text-btn" class="mt-3 w-full bg-secondary hover:bg-secondary/90 text-white font-medium py-2 px-4 rounded-md transition-custom flex items-center justify-center">
								<i class="fa fa-font mr-2"></i>æ·»åŠ æ–‡å­—
							</button>
						</div>

						<!-- æ–‡å­—æ ·å¼ -->
						<div class="mb-6">
							<h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center">
								<i class="fa fa-paint-brush mr-2"></i>æ–‡å­—æ ·å¼
							</h3>

							<!-- å­—ä½“å¤§å° -->
							<div class="mb-4">
								<label for="font-size" class="block text-xs text-gray-500 mb-1">å­—ä½“å¤§å°</label>
								<div class="flex items-center space-x-3">
									<input type="range" id="font-size" min="12" max="100" value="36" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<span id="font-size-value" class="text-sm font-medium text-gray-700 min-w-[2.5rem] text-right">36px</span>
								</div>
							</div>

							<!-- å­—ä½“é¢œè‰² -->
							<div class="mb-4">
								<label for="text-color" class="block text-xs text-gray-500 mb-1">å­—ä½“é¢œè‰²</label>
								<div class="flex items-center space-x-4">
									<input type="color" id="text-color" value="#ffffff" class="w-8 h-8 rounded-full border-0 cursor-pointer">
									<input type="text" id="text-color-text" value="#ffffff" class="w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm">
								</div>
							</div>

							<!-- å¯¹é½æ–¹å¼ -->
							<div class="mb-4">
								<label class="block text-xs text-gray-500 mb-1">å¯¹é½æ–¹å¼</label>
								<div class="flex space-x-2">
									<button class="text-align-btn flex-1 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom" data-align="left">
										<i class="fa fa-align-left"></i>
									</button>
									<button class="text-align-btn flex-1 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom" data-align="center">
										<i class="fa fa-align-center"></i>
									</button>
									<button class="text-align-btn flex-1 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom" data-align="right">
										<i class="fa fa-align-right"></i>
									</button>
								</div>
							</div>

							<!-- å­—ä½“æ ·å¼ -->
							<div class="flex flex-wrap gap-2 mb-4">
								<button id="bold-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<b>B</b>
								</button>
								<button id="italic-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<i>I</i>
								</button>
								<button id="underline-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<u>U</u>
								</button>
								<button id="stroke-btn" class="py-1 px-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-custom text-sm">
									<span style="text-decoration: line-through;">S</span>
								</button>
							</div>

							<!-- æ–‡å­—é˜´å½± -->
							<div>
								<label class="flex items-center justify-between text-xs text-gray-500 mb-1">
									<span>æ–‡å­—é˜´å½±</span>
									<span id="shadow-value" class="text-gray-700">å…³</span>
								</label>
								<div class="flex items-center space-x-2">
									<input type="range" id="text-shadow" min="0" max="10" value="0" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<button id="shadow-toggle" class="text-gray-400 hover:text-gray-600 transition-custom">
										<i class="fa fa-toggle-off"></i>
									</button>
								</div>
							</div>
						</div>

						<!-- ä½ç½®è°ƒæ•´ -->
						<div class="mb-6">
							<h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center">
								<i class="fa fa-arrows-alt mr-2"></i>ä½ç½®è°ƒæ•´
							</h3>

							<!-- X ä½ç½® -->
							<div class="mb-4">
								<label for="pos-x" class="block text-xs text-gray-500 mb-1">æ°´å¹³ä½ç½®</label>
								<div class="flex items-center space-x-3">
									<input type="range" id="pos-x" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<span id="pos-x-value" class="text-sm font-medium text-gray-700 min-w-[2.5rem] text-right">50%</span>
								</div>
							</div>

							<!-- Y ä½ç½® -->
							<div>
								<label for="pos-y" class="block text-xs text-gray-500 mb-1">å‚ç›´ä½ç½®</label>
								<div class="flex items-center space-x-3">
									<input type="range" id="pos-y" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
									<span id="pos-y-value" class="text-sm font-medium text-gray-700 min-w-[2.5rem] text-right">50%</span>
								</div>
							</div>
						</div>

						<!-- æ“ä½œæŒ‰é’® -->
						<div class="flex space-x-3">
							<button id="reset-btn" class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 font-medium hover:bg-gray-50 transition-custom">
								<i class="fa fa-refresh mr-1"></i>é‡ç½®
							</button>
							<button id="save-btn" class="flex-1 px-4 py-2 bg-primary hover:bg-primary/90 text-white font-medium rounded-md transition-custom">
								<i class="fa fa-download mr-1"></i>ä¿å­˜å›¾ç‰‡
							</button>
						</div>
					</div>
				</div>

				<!-- å³ä¾§é¢„è§ˆåŒº -->
				<div class="lg:col-span-2">
					<div class="bg-white rounded-xl shadow-soft p-6 h-full">
						<h2 class="text-xl font-bold text-gray-800 mb-6">é¢„è§ˆåŒºåŸŸ</h2>

						<div id="canvas-container" class="relative bg-neutral rounded-lg overflow-hidden" style="height: 600px;">
							<!-- ç”»å¸ƒå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
							<canvas id="image-canvas" class="w-full h-full"></canvas>

							<!-- æ— å›¾ç‰‡æç¤º -->
							<div id="no-image-placeholder" class="absolute inset-0 flex flex-col items-center justify-center text-gray-400">
								<i class="fa fa-image text-6xl mb-4"></i>
								<p class="text-lg">è¯·ä¸Šä¼ ä¸€å¼ å›¾ç‰‡å¼€å§‹ç¼–è¾‘</p>
							</div>
						</div>

						<!-- æç¤ºä¿¡æ¯ -->
						<div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-700">
							<h4 class="font-medium mb-2 flex items-center">
								<i class="fa fa-lightbulb-o mr-2"></i>æç¤º
							</h4>
							<ul class="list-disc pl-5 space-y-1">
								<li>æ·»åŠ æ–‡å­—åï¼Œå¯ä»¥è°ƒæ•´å…¶ä½ç½®å’Œæ ·å¼</li>
								<li>å¯ä»¥æ·»åŠ å¤šä¸ªæ–‡å­—ï¼Œæ¯ä¸ªæ–‡å­—éƒ½æ˜¯ç‹¬ç«‹å¯ç¼–è¾‘çš„</li>
								<li>ç‚¹å‡»å·²æ·»åŠ çš„æ–‡å­—å¯ä»¥é€‰ä¸­å®ƒè¿›è¡Œç¼–è¾‘</li>
								<li>ä½¿ç”¨æ»‘å—å¯ä»¥ç²¾ç¡®æ§åˆ¶æ–‡å­—çš„ä½ç½®å’Œå¤§å°</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

</div>

<script>
	// DOM å…ƒç´ 
	const dropArea = document.getElementById('drop-area');
	const fileInput = document.getElementById('file-input');
	const imagePreview = document.getElementById('image-preview');
	const previewImg = document.getElementById('preview-img');
	const removeImg = document.getElementById('remove-img');
	const textInput = document.getElementById('text-input');
	const addTextBtn = document.getElementById('add-text-btn');
	const fontSize = document.getElementById('font-size');
	const fontSizeValue = document.getElementById('font-size-value');
	const textColor = document.getElementById('text-color');
	const textColorText = document.getElementById('text-color-text');
	const textAlignBtns = document.querySelectorAll('.text-align-btn');
	const boldBtn = document.getElementById('bold-btn');
	const italicBtn = document.getElementById('italic-btn');
	const underlineBtn = document.getElementById('underline-btn');
	const strokeBtn = document.getElementById('stroke-btn');
	const textShadow = document.getElementById('text-shadow');
	const shadowValue = document.getElementById('shadow-value');
	const shadowToggle = document.getElementById('shadow-toggle');
	const posX = document.getElementById('pos-x');
	const posXValue = document.getElementById('pos-x-value');
	const posY = document.getElementById('pos-y');
	const posYValue = document.getElementById('pos-y-value');
	const resetBtn = document.getElementById('reset-btn');
	const saveBtn = document.getElementById('save-btn');
	const canvas = document.getElementById('image-canvas');
	const ctx = canvas.getContext('2d');
	const noImagePlaceholder = document.getElementById('no-image-placeholder');

	// å­˜å‚¨å½“å‰ç¼–è¾‘çš„æ–‡æœ¬å¯¹è±¡ç´¢å¼•
	let currentTextIndex = -1;

	// å­˜å‚¨æ‰€æœ‰æ·»åŠ çš„æ–‡æœ¬å¯¹è±¡
	let texts = [];

	// å›¾ç‰‡å¯¹è±¡
	let image = null;

	// æ–‡æœ¬æ ·å¼é»˜è®¤å€¼
	let textStyle = {
		fontSize: 36,
		color: '#ffffff',
		align: 'center',
		bold: false,
		italic: false,
		underline: false,
		stroke: false,
		shadow: 0,
		posX: 50,
		posY: 50
	};

	// åˆå§‹åŒ–ç”»å¸ƒå°ºå¯¸
	function initCanvasSize() {
		const container = document.getElementById('canvas-container');
		canvas.width = container.clientWidth;
		canvas.height = container.clientHeight;
		redrawCanvas();
	}

	// ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼Œè°ƒæ•´ç”»å¸ƒå°ºå¯¸
	window.addEventListener('resize', initCanvasSize);

	// åˆå§‹åŒ–
	initCanvasSize();

	// æ‹–æ”¾äº‹ä»¶å¤„ç†
	['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
		dropArea.addEventListener(eventName, preventDefaults, false);
	});

	function preventDefaults(e) {
		e.preventDefault();
		e.stopPropagation();
	}

	['dragenter', 'dragover'].forEach(eventName => {
		dropArea.addEventListener(eventName, highlight, false);
	});

	['dragleave', 'drop'].forEach(eventName => {
		dropArea.addEventListener(eventName, unhighlight, false);
	});

	function highlight() {
		dropArea.classList.add('border-primary', 'bg-primary/5');
	}

	function unhighlight() {
		dropArea.classList.remove('border-primary', 'bg-primary/5');
	}

	dropArea.addEventListener('drop', handleDrop, false);

	function handleDrop(e) {
		const dt = e.dataTransfer;
		const file = dt.files[0];
		if (file) {
			handleFile(file);
		}
	}

	// æ–‡ä»¶é€‰æ‹©
	fileInput.addEventListener('change', () => {
		const file = fileInput.files[0];
		if (file) {
			handleFile(file);
		}
	});

	// ç§»é™¤å›¾ç‰‡
	removeImg.addEventListener('click', () => {
		image = null;
		imagePreview.classList.add('hidden');
		noImagePlaceholder.classList.remove('hidden');
		redrawCanvas();
	});

	// å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶
	function handleFile(file) {
		if (!file.type.match('image.*')) {
			alert('è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼');
			return;
		}

		const reader = new FileReader();

		reader.onload = function(e) {
			image = new Image();
			image.onload = function() {
				// æ˜¾ç¤ºé¢„è§ˆ
				previewImg.src = e.target.result;
				imagePreview.classList.remove('hidden');
				noImagePlaceholder.classList.add('hidden');

				// é‡ç»˜ç”»å¸ƒ
				redrawCanvas();
			};
			image.src = e.target.result;
		};

		reader.readAsDataURL(file);
	}

	// æ·»åŠ æ–‡å­—
	addTextBtn.addEventListener('click', () => {
		const text = textInput.value.trim();
		if (!text) {
			alert('è¯·è¾“å…¥æ–‡å­—å†…å®¹ï¼');
			return;
		}

		// æ·»åŠ æ–°æ–‡æœ¬å¯¹è±¡
		texts.push({
			text,
			...textStyle
		});

		// æ›´æ–°å½“å‰æ–‡æœ¬ç´¢å¼•
		currentTextIndex = texts.length - 1;

		// æ¸…ç©ºè¾“å…¥æ¡†
		textInput.value = '';

		// é‡ç»˜ç”»å¸ƒ
		redrawCanvas();
	});

	// ç”»å¸ƒç‚¹å‡»äº‹ä»¶ - é€‰æ‹©æ–‡æœ¬
	canvas.addEventListener('click', (e) => {
		if (!image) return;

		const rect = canvas.getBoundingClientRect();
		const clickX = e.clientX - rect.left;
		const clickY = e.clientY - rect.top;

		// ä»åå¾€å‰æ£€æŸ¥ï¼Œä¼˜å…ˆé€‰æ‹©æœ€ä¸Šé¢çš„æ–‡æœ¬
		for (let i = texts.length - 1; i >= 0; i--) {
			const text = texts[i];
			ctx.save();
			ctx.font = getFontString(text);
			const textWidth = ctx.measureText(text.text).width;
			const textHeight = text.fontSize;

			// è®¡ç®—æ–‡æœ¬åŒ…å›´ç›’
			let x, y;
			if (text.align === 'left') {
				x = (text.posX / 100) * canvas.width;
			} else if (text.align === 'center') {
				x = (text.posX / 100) * canvas.width - textWidth / 2;
			} else { // right
				x = (text.posX / 100) * canvas.width - textWidth;
			}
			y = (text.posY / 100) * canvas.height;

			// æ£€æŸ¥ç‚¹å‡»æ˜¯å¦åœ¨æ–‡æœ¬èŒƒå›´å†…
			if (clickX >= x && clickX <= x + textWidth &&
					clickY >= y - textHeight && clickY <= y) {
				currentTextIndex = i;
				updateControls();
				redrawCanvas();
				ctx.restore();
				return;
			}
			ctx.restore();
		}

		// å¦‚æœæ²¡æœ‰ç‚¹å‡»åˆ°ä»»ä½•æ–‡æœ¬ï¼Œå–æ¶ˆé€‰æ‹©
		currentTextIndex = -1;
		redrawCanvas();
	});

	// æ›´æ–°æ§åˆ¶é€‰é¡¹
	function updateControls() {
		if (currentTextIndex === -1) {
			// æ²¡æœ‰é€‰ä¸­çš„æ–‡æœ¬ï¼Œé‡ç½®ä¸ºé»˜è®¤æ ·å¼
			textStyle = {
				fontSize: 36,
				color: '#ffffff',
				align: 'center',
				bold: false,
				italic: false,
				underline: false,
				stroke: false,
				shadow: 0,
				posX: 50,
				posY: 50
			};
		} else {
			// ä½¿ç”¨é€‰ä¸­çš„æ–‡æœ¬æ ·å¼
			textStyle = { ...texts[currentTextIndex] };
		}

		// æ›´æ–°UI
		fontSize.value = textStyle.fontSize;
		fontSizeValue.textContent = `${textStyle.fontSize}px`;

		textColor.value = textStyle.color;
		textColorText.value = textStyle.color;

		textAlignBtns.forEach(btn => {
			if (btn.dataset.align === textStyle.align) {
				btn.classList.add('bg-primary/10', 'border-primary');
			} else {
				btn.classList.remove('bg-primary/10', 'border-primary');
			}
		});

		boldBtn.classList.toggle('bg-primary/10', textStyle.bold);
		italicBtn.classList.toggle('bg-primary/10', textStyle.italic);
		underlineBtn.classList.toggle('bg-primary/10', textStyle.underline);
		strokeBtn.classList.toggle('bg-primary/10', textStyle.stroke);

		textShadow.value = textStyle.shadow;
		shadowValue.textContent = textStyle.shadow > 0 ? 'å¼€' : 'å…³';
		shadowToggle.innerHTML = textStyle.shadow > 0 ?
				'<i class="fa fa-toggle-on text-primary"></i>' :
				'<i class="fa fa-toggle-off text-gray-400"></i>';

		posX.value = textStyle.posX;
		posXValue.textContent = `${textStyle.posX}%`;

		posY.value = textStyle.posY;
		posYValue.textContent = `${textStyle.posY}%`;
	}

	// ç›‘å¬å­—ä½“å¤§å°å˜åŒ–
	fontSize.addEventListener('input', () => {
		textStyle.fontSize = parseInt(fontSize.value);
		fontSizeValue.textContent = `${textStyle.fontSize}px`;
		updateCurrentText();
	});

	// ç›‘å¬æ–‡æœ¬é¢œè‰²å˜åŒ–
	textColor.addEventListener('input', () => {
		textStyle.color = textColor.value;
		textColorText.value = textColor.value;
		updateCurrentText();
	});

	textColorText.addEventListener('input', () => {
		if (/^#([0-9A-F]{3}){1,2}$/i.test(textColorText.value)) {
			textStyle.color = textColorText.value;
			textColor.value = textColorText.value;
			updateCurrentText();
		}
	});

	// ç›‘å¬å¯¹é½æ–¹å¼å˜åŒ–
	textAlignBtns.forEach(btn => {
		btn.addEventListener('click', () => {
			// ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
			textAlignBtns.forEach(b => {
				b.classList.remove('bg-primary/10', 'border-primary');
			});

			// æ·»åŠ å½“å‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
			btn.classList.add('bg-primary/10', 'border-primary');

			// æ›´æ–°æ ·å¼
			textStyle.align = btn.dataset.align;
			updateCurrentText();
		});
	});

	// ç›‘å¬å­—ä½“æ ·å¼å˜åŒ–
	boldBtn.addEventListener('click', () => {
		textStyle.bold = !textStyle.bold;
		boldBtn.classList.toggle('bg-primary/10', textStyle.bold);
		updateCurrentText();
	});

	italicBtn.addEventListener('click', () => {
		textStyle.italic = !textStyle.italic;
		italicBtn.classList.toggle('bg-primary/10', textStyle.italic);
		updateCurrentText();
	});

	underlineBtn.addEventListener('click', () => {
		textStyle.underline = !textStyle.underline;
		underlineBtn.classList.toggle('bg-primary/10', textStyle.underline);
		updateCurrentText();
	});

	strokeBtn.addEventListener('click', () => {
		textStyle.stroke = !textStyle.stroke;
		strokeBtn.classList.toggle('bg-primary/10', textStyle.stroke);
		updateCurrentText();
	});

	// ç›‘å¬æ–‡å­—é˜´å½±å˜åŒ–
	textShadow.addEventListener('input', () => {
		textStyle.shadow = parseInt(textShadow.value);
		shadowValue.textContent = textStyle.shadow > 0 ? 'å¼€' : 'å…³';
		shadowToggle.innerHTML = textStyle.shadow > 0 ?
				'<i class="fa fa-toggle-on text-primary"></i>' :
				'<i class="fa fa-toggle-off text-gray-400"></i>';
		updateCurrentText();
	});

	shadowToggle.addEventListener('click', () => {
		textStyle.shadow = textStyle.shadow > 0 ? 0 : 3;
		textShadow.value = textStyle.shadow;
		shadowValue.textContent = textStyle.shadow > 0 ? 'å¼€' : 'å…³';
		shadowToggle.innerHTML = textStyle.shadow > 0 ?
				'<i class="fa fa-toggle-on text-primary"></i>' :
				'<i class="fa fa-toggle-off text-gray-400"></i>';
		updateCurrentText();
	});

	// ç›‘å¬ä½ç½®å˜åŒ–
	posX.addEventListener('input', () => {
		textStyle.posX = parseInt(posX.value);
		posXValue.textContent = `${textStyle.posX}%`;
		updateCurrentText();
	});

	posY.addEventListener('input', () => {
		textStyle.posY = parseInt(posY.value);
		posYValue.textContent = `${textStyle.posY}%`;
		updateCurrentText();
	});

	// é‡ç½®æŒ‰é’®
	resetBtn.addEventListener('click', () => {
		if (currentTextIndex !== -1) {
			// å¦‚æœæœ‰é€‰ä¸­çš„æ–‡æœ¬ï¼Œåªé‡ç½®è¯¥æ–‡æœ¬
			texts.splice(currentTextIndex, 1);
			currentTextIndex = -1;
			updateControls();
			redrawCanvas();
		} else {
			// å¦åˆ™é‡ç½®æ‰€æœ‰
			texts = [];
			currentTextIndex = -1;
			updateControls();
			redrawCanvas();
		}
	});

	// ä¿å­˜æŒ‰é’®
	saveBtn.addEventListener('click', () => {
		if (!image && texts.length === 0) {
			alert('è¯·å…ˆä¸Šä¼ å›¾ç‰‡å¹¶æ·»åŠ æ–‡å­—ï¼');
			return;
		}

		// åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸´æ—¶ç”»å¸ƒï¼Œç¡®ä¿å›¾ç‰‡è´¨é‡
		const tempCanvas = document.createElement('canvas');
		const tempCtx = tempCanvas.getContext('2d');

		// è®¾ç½®ä¸´æ—¶ç”»å¸ƒå°ºå¯¸ä¸ºå›¾ç‰‡åŸå§‹å°ºå¯¸
		if (image) {
			tempCanvas.width = image.width;
			tempCanvas.height = image.height;

			// ç»˜åˆ¶å›¾ç‰‡
			tempCtx.drawImage(image, 0, 0);
		} else {
			// å¦‚æœæ²¡æœ‰å›¾ç‰‡ï¼Œä½¿ç”¨å½“å‰ç”»å¸ƒå°ºå¯¸
			tempCanvas.width = canvas.width;
			tempCanvas.height = canvas.height;

			// è®¾ç½®èƒŒæ™¯è‰²
			tempCtx.fillStyle = '#ffffff';
			tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
		}

		// ç»˜åˆ¶æ‰€æœ‰æ–‡æœ¬
		texts.forEach(text => {
			drawText(tempCtx, text, tempCanvas.width, tempCanvas.height);
		});

		// åˆ›å»ºä¸‹è½½é“¾æ¥
		const link = document.createElement('a');
		link.download = 'image-with-text.png';
		link.href = tempCanvas.toDataURL('image/png');
		link.click();
	});

	// æ›´æ–°å½“å‰é€‰ä¸­çš„æ–‡æœ¬
	function updateCurrentText() {
		if (currentTextIndex !== -1) {
			texts[currentTextIndex] = { ...textStyle };
			redrawCanvas();
		}
	}

	// è·å–å­—ä½“å­—ç¬¦ä¸²
	function getFontString(text) {
		let font = '';
		if (text.italic) font += 'italic ';
		if (text.bold) font += 'bold ';
		font += `${text.fontSize}px Inter, sans-serif`;
		return font;
	}

	// ç»˜åˆ¶æ–‡æœ¬
	function drawText(ctx, text, canvasWidth, canvasHeight) {
		ctx.save();

		// è®¾ç½®å­—ä½“å’Œæ ·å¼
		ctx.font = getFontString(text);
		ctx.fillStyle = text.color;
		ctx.textAlign = text.align;
		ctx.textBaseline = 'middle';

		// è®¾ç½®é˜´å½±
		if (text.shadow > 0) {
			ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
			ctx.shadowBlur = text.shadow;
			ctx.shadowOffsetX = 2;
			ctx.shadowOffsetY = 2;
		}

		// è®¡ç®—æ–‡æœ¬ä½ç½®
		let x, y;
		if (text.align === 'left') {
			x = (text.posX / 100) * canvasWidth;
		} else if (text.align === 'center') {
			x = (text.posX / 100) * canvasWidth;
		} else { // right
			x = (text.posX / 100) * canvasWidth;
		}
		y = (text.posY / 100) * canvasHeight;

		// ç»˜åˆ¶æ–‡æœ¬
		ctx.fillText(text.text, x, y);

		// ç»˜åˆ¶ä¸‹åˆ’çº¿æˆ–åˆ é™¤çº¿
		if (text.underline || text.stroke) {
			const textWidth = ctx.measureText(text.text).width;
			const lineY = text.stroke ? y - text.fontSize / 8 : y + text.fontSize / 3;

			ctx.beginPath();
			ctx.moveTo(x - textWidth / 2, lineY);
			ctx.lineTo(x + textWidth / 2, lineY);
			ctx.lineWidth = 2;
			ctx.strokeStyle = text.color;
			ctx.stroke();
		}

		// å¦‚æœæ˜¯å½“å‰é€‰ä¸­çš„æ–‡æœ¬ï¼Œç»˜åˆ¶é€‰ä¸­æ¡†
		if (currentTextIndex !== -1 && texts[currentTextIndex] === text) {
			const textWidth = ctx.measureText(text.text).width;
			const padding = 10;

			ctx.strokeStyle = '#165DFF';
			ctx.lineWidth = 2;
			ctx.setLineDash([5, 3]);

			ctx.strokeRect(
					x - textWidth / 2 - padding,
					y - text.fontSize / 2 - padding,
					textWidth + padding * 2,
					text.fontSize + padding * 2
			);

			ctx.setLineDash([]);
		}

		ctx.restore();
	}

	// é‡ç»˜ç”»å¸ƒ
	function redrawCanvas() {
		// æ¸…ç©ºç”»å¸ƒ
		ctx.clearRect(0, 0, canvas.width, canvas.height);

		// å¦‚æœæœ‰å›¾ç‰‡ï¼Œç»˜åˆ¶å›¾ç‰‡
		if (image) {
			// è®¡ç®—å›¾ç‰‡åœ¨ç”»å¸ƒä¸­çš„æœ€ä½³æ˜¾ç¤ºä½ç½®ï¼ˆå±…ä¸­ä¸”ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼‰
			const imgRatio = image.width / image.height;
			const canvasRatio = canvas.width / canvas.height;

			let displayWidth, displayHeight, x, y;

			if (imgRatio > canvasRatio) {
				// å›¾ç‰‡æ¯”ç”»å¸ƒå®½ï¼Œä»¥å®½åº¦ä¸ºåŸºå‡†
				displayWidth = canvas.width;
				displayHeight = canvas.width / imgRatio;
				x = 0;
				y = (canvas.height - displayHeight) / 2;
			} else {
				// å›¾ç‰‡æ¯”ç”»å¸ƒé«˜ï¼Œä»¥é«˜åº¦ä¸ºåŸºå‡†
				displayHeight = canvas.height;
				displayWidth = canvas.height * imgRatio;
				x = (canvas.width - displayWidth) / 2;
				y = 0;
			}

			// ç»˜åˆ¶å›¾ç‰‡
			ctx.drawImage(image, x, y, displayWidth, displayHeight);

			// ä¿å­˜å›¾ç‰‡çš„æ˜¾ç¤ºä¿¡æ¯ï¼Œç”¨äºæ–‡æœ¬å®šä½
			image.displayInfo = { x, y, width: displayWidth, height: displayHeight };
		}

		// ç»˜åˆ¶æ‰€æœ‰æ–‡æœ¬
		texts.forEach(text => {
			drawText(ctx, text, canvas.width, canvas.height);
		});
	}

</script>
</body>

<script>
	function toggleMenu() {
		const nav = document.querySelector('.nav-categories');
		nav.classList.toggle('active');

		// ç‚¹å‡»èœå•é¡¹åè‡ªåŠ¨å…³é—­
		document.querySelectorAll('.nav-category').forEach(item => {
			item.addEventListener('click', () => {
				if (window.innerWidth <= 768) {
					nav.classList.remove('active');
				}
			});
		});
	}
</script>



</html>